<% provide(:title, "Compare #{@category.name}") %>

<div class="container-fluid">
	<div class="row">
		<div class="col-lg-12 list-h1">
			<h1><%= "Compare #{@category.gears.count} #{@category.name}" %></h1>
			<p>Try clicking on a column header... then hold down the shift key and click on a second, and a third!</p>
		</div>
	</div>
	<div class="row">
		<div class="col-lg-12">
			<table id="gear-list" class="gear-list table table-hover table-striped table-bordered table-condensed">
				<thead>
					<tr>
						<% @category.gears.first.attributes.each do |attribute, value| %>
							<% unless ['id', 'created_at', 'updated_at', 'category_id', 'is_api_searchable', 'large_image_url', 'thumb_image_url'].include?(attribute) || !value.present? %>
								<th><%= attribute.gsub('gear_', '').titleize %></th>
							<% end %>
						<% end %>
						<th>Price</th>
					</tr>
				</thead>

				<tbody>
					<% @category.gears.each do |gear| %>
						<tr>
							<% gear.attributes.each do |attribute, value| %>
								<% unless ['id', 'created_at', 'updated_at', 'category_id', 'is_api_searchable', 'large_image_url', 'thumb_image_url'].include?(attribute) || !value.present? %>
									<% if attribute == 'name' %>
										<td><%= link_to value, gear_path(gear) %></td>
									<% elsif attribute == 'weight' %>
										<td class="gear-list-weight-td"><%= value.to_f / 1000 %></td>
									<% else %>
										<td><%= value %></td>
									<% end %>
								<% end %>
							<% end %>
							<td><%= link_to "Show Price", search_path(q: gear.name) %></td>
						</tr>
					<% end %>
				</tbody>
			</table>
		</div>
	</div>
</div>

<script type="text/javascript">

	$(document).ready(function() {
		$('#gear-list').DataTable({
			"aaSorting": [[1, 'asc']],
			"bPaginate": false,
			"bInfo": false,
			"aoColumnDefs": [
			  {
			    "sType": "num-html",
			    "aTargets": [-1]
			  }
			]
		});
	});

</script>

